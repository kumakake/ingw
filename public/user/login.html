<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åˆ©ç”¨è€…ãƒ­ã‚°ã‚¤ãƒ³ - Instagram OAuth Service</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body class="auth-page">
  <div id="header"></div>
  
  <div class="auth-container">
    <div class="auth-card card">
      <div class="auth-header">
        <div class="auth-logo">ğŸ”</div>
        <h1 class="auth-title">åˆ©ç”¨è€…ãƒ­ã‚°ã‚¤ãƒ³</h1>
        <p class="auth-subtitle">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„</p>
      </div>
      
      <div id="messageContainer"></div>
      
      <form id="loginForm" onsubmit="handleLogin(event)">
        <div class="form-group">
          <label for="loginAccount">ãƒ­ã‚°ã‚¤ãƒ³ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</label>
          <input type="text" id="loginAccount" class="form-input" required placeholder="ãƒ­ã‚°ã‚¤ãƒ³ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å…¥åŠ›">
        </div>
        
        <div class="form-group">
          <label for="password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
          <input type="password" id="password" class="form-input" required placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
        </div>
        
        <button type="submit" class="btn btn-primary btn-lg" style="width: 100%;">
          ãƒ­ã‚°ã‚¤ãƒ³
        </button>
      </form>
      
      <div class="auth-footer">
        <p><a href="/user/forgot-password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãŠå¿˜ã‚Œã§ã™ã‹ï¼Ÿ</a></p>
        <p class="mt-4">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ãªã„æ–¹ã¯<br><a href="/user/send-verification">åˆ©ç”¨è€…æ–°è¦ç™»éŒ²</a></p>
      </div>
    </div>
  </div>
  
  <script src="/js/common.js"></script>
  <script>
    // Check if already logged in
    if (TokenManager.isLoggedIn()) {
      window.location.href = '/user/dashboard';
    }
    
    async function handleLogin(e) {
      e.preventDefault();
      
      const loginAccount = document.getElementById('loginAccount').value;
      const password = document.getElementById('password').value;
      
      try {
        const response = await fetch('/api/user/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ loginAccount, password })
        });
        
        const data = await response.json();
        
        if (data.success) {
          TokenManager.set(data.token);
          TokenManager.setUser(data.user);
          window.location.href = '/user/dashboard';
        } else {
          showMessage(data.error || 'ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
        }
      } catch (error) {
        showMessage('é€šä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ', 'error');
      }
    }
  </script>
</body>
</html>
